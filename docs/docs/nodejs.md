---
outline: deep
---



# Nodejs

### Nodejs 如何支持高并发

主要是因为其采用了非阻塞 I/O 和事件驱动的设计模式

1、非阻塞 I/O：在传统的同步（阻塞）I/O 操作中，当我们发出一个 I/O 请求（如读取文件、查询数据库等）后，需要等待这个请求完成后才能继续执行后续的代码。这样就会造成线程的阻塞，如果并发请求量大，就需要创建大量的线程来处理，这对系统资源是一种极大的浪费。而 Node.js 采用的是非阻塞 I/O，当发出 I/O 请求后，不需要等待其完成，可以直接执行后续的代码，当 I/O 请求完成后，通过事件驱动的方式通知 Node.js 进行处理

事件驱动：Node.js 中的所有操作，包括网络请求、数据库操作等，都是以异步事件的形式存在的。当这些操作完成时，会触发相应的事件，然后通过事件循环机制处理这些事件。这样就可以避免阻塞，提高了并发处理的能力

这种设计模式使得 Node.js 在处理高并发请求时，能够有很高的效率和性能。







### BFF

BFF，全称为 Backend For Frontend，即“面向前端的后端”。这是一种微服务架构模式，主要目的是为了解决客户端与多个微服务直接交互带来的复杂性问题。

在微服务架构中，每个服务都有自己的职责和接口，这样可以使服务更加独立、可复用和可扩展。然而，这也意味着客户端需要与多个服务进行交互，这可能会导致客户端的复杂性增加，例如需要处理多个服务的接口、数据格式和错误处理等

BFF 的出现就是为了解决这个问题。BFF 作为一个中间层，位于客户端和微服务之间，它将所有的微服务聚合到一个接口中，然后提供给客户端。这样，客户端只需要与 BFF 进行交互，而不需要关心后端的微服务

BFF 还可以根据不同的客户端（如移动端、Web 端）提供不同的接口和数据格式，这样可以更好地满足不同客户端的需求。  

总的来说，BFF 的主要优点有：

- 简化了客户端的复杂性
- 提高了微服务的复用性
- 提供了更好的用户体验，因为 BFF 可以根据不同的客户端提供定制化的服务。



### 中间件

中间件是介于应用系统和系统软件之间的一类软件，它使用系统软件提供的基础服务或功能，衔接应用系统的各个部分或不同的应用，能达到资源共享、功能共享的目的。

在nodejs中，主要指封装一些http请求细节处理的方法，隐藏实现细节，把基础功能和业务逻辑隔离，优化程序结构，提高开发效率。

一次http请求包含很多工作，如记录日志、ip过滤、查询字符串、请求体解析、cookie处理、权限验证、异常处理等，对于web应用而言，不希望接触到这么多细节的处理，因此引入中间件来简化和隔离这些基础设施与业务逻辑之间的细节，提升开发效率。



### nodejs中的事件循环

任务类型：

- 微任务队列
- process.nextTick
- 计时器队列
- I/O队列
- check队列，执行setImmediate的回调
- close队列，关闭资源



### buffer

nodejs中用于处理二进制数据的类，与I/O相关的操作均基于Buffer。其内存在V8堆栈外分配原始内存空间，占用空间大小原固定，实例创建后不能再调整。
